<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vote for Next Book</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>Vote for the Next Book</h1>
  </header>
  <main>
    <section id="vote-container">
      <form id="vote-form">
        <label for="book">Select a book to vote for:</label>
        <select id="book" name="book">
          <option value="book1">Book 1</option>
          <option value="book2">Book 2</option>
          <option value="book3">Book 3</option>
          <option value="book4">Book 4</option>
        </select>
        <button type="submit">Submit Vote</button>
      </form>
    </section>

    <section id="vote-results">
      <h2>Voting Results</h2>
      <canvas id="voteChart" width="400" height="200"></canvas>
    </section>

    <section id="navigation">
      <button onclick="window.location.href='index.html'">Back to Home</button>
      <button onclick="window.location.href='chat.html'">Join Book Club Chat</button>
      <button onclick="window.location.href='Calendar.html'">Check Your Calendar</button>
    </section>
  </main>

  <script>
    // Set up the initial vote counts for each book
    let voteCounts = {
      book1: 0,
      book2: 0,
      book3: 0,
      book4: 0
    };

    // Get the selected book and increment its vote count
    document.getElementById('vote-form').addEventListener('submit', function(event) {
      event.preventDefault();
      const selectedBook = document.getElementById('book').value;
      voteCounts[selectedBook] += 1;  // Increment the vote for the selected book
      alert(`You voted for: ${selectedBook}`);
      updateChart();  // Update the chart after each vote
    });

    // Create the chart instance globally so it can be updated
    let voteChartInstance;

    // Function to update the chart with the latest vote counts
    function updateChart() {
      const ctx = document.getElementById('voteChart').getContext('2d');

      // If the chart doesn't exist yet, create a new one
      if (!voteChartInstance) {
        voteChartInstance = new Chart(ctx, {
          type: 'bar', // Bar chart type
          data: {
            labels: ['Book 1', 'Book 2', 'Book 3', 'Book 4'], // Book names as labels
            datasets: [{
              label: 'Votes',
              data: [
                voteCounts.book1,
                voteCounts.book2,
                voteCounts.book3,
                voteCounts.book4
              ],
              backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#FF5722'], // Green, Blue, Orange, Red
              borderColor: ['#388E3C', '#1976D2', '#F57C00', '#D32F2F'],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      } else {
        // If the chart already exists, update the data and refresh
        voteChartInstance.data.datasets[0].data = [
          voteCounts.book1,
          voteCounts.book2,
          voteCounts.book3,
          voteCounts.book4
        ];
        voteChartInstance.update();
      }
    }

    // Initial chart rendering
    updateChart();
  </script>
</body>
</html>

